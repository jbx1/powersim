<html>
<head>
    <title>Powersim Reporter - Simulation: $simulation.getName() [$simulation.getId()]</title>
    <link rel="stylesheet" href="../../css/powersim.css" type="text/css">
    <script type="text/javascript" src="../../js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="../../js/dygraph-combined.js"></script>
    <script>
        simulation_id = $simulation.getId();
    </script>
</head>
<body>
<div id="content">
    <h1>Powersim Reporter</h1>
    <div>
        <h2>Simulation: $simulation.getName() [$simulation.getId()]</h2>
        <a href="../simulations/">Back to Simulation list</a>

        <div id="data">
        <table cellpadding="2" cellspacing="1">
            <tr>
                <th>Households: </th><td>$households</td>
                <th>Appliances: </th><td>$appliances</td>
            </tr>
        </table>

        <table cellpadding="2" cellspacing="1">
            <tr><td></td><th>Simulated</th><th>Actual</th></comment></tr>
            <tr><th>Start Time</th><td>$simulation.getSimulatedStartTime()</td><td>$simulation.getActualStartTime()</td></tr>
            #if ($simulation.getSimulatedEndTime())
              <tr><th>End Time</th><td>$simulation.getSimulatedEndTime()</td><td>$simulation.getActualEndTime()</td></tr>
            #else
                <tr><th colspan="3" align="center">Simulation still running (or terminated prematurely)</th></tr>
            #end
        </table>
        </div>
    </div>
    <div>

    </div>

    <div id="graphdiv"></div>

    <script type="text/javascript">
        data_temp = [[0,0,0,0]];
        graph = new Dygraph(document.getElementById("graphdiv"),
        data_temp,
            {
                fillGraph: true,
                labelsKMB: true,
                title: 'Simulated Load',
                ylabel: 'Watts',
                labels: ['Date/Time', 'Generated', 'Consumed', 'Net Load'],
                labelsSeparateLines: true,
                legend: 'always',
                labelsDivStyles: { 'textAlign': 'right' },
                labelsDivWidth: 150,
                showRangeSelector: true,
                strokeWidth: 1,
                'Net Load': { strokeWidth: 1  },
                colors: ['#408000', '#400080', '#B04000']

            }
        );
    </script>

    <script>
        $(document).ready(function()
        {
            $.getJSON('./data/'+simulation_id, function(simdata)
            {
                var i;
                for (i = 0; i < simdata.length; i++)
                {
                  simdata[i][0] = new Date(simdata[i][0]);
                }

                graph.updateOptions({file : simdata});
            });
        });
    </script>
</div>
</body>
</html>